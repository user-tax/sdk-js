"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var l=require("msgpackr"),y=e=>{var r;return r=e.length,r?(1===r&&([r]=e,Array.isArray(r)||(e=r)),JSON.stringify(e)):""},f="Content-Type";exports.default=c=>{var i,u,o={},n=async(r,t)=>{var e,a,n,s,i,u;if(a=t["headers"],a)for(u of Object.entries(o))[n,i]=u,n in a||(a[n]=i);else t.headers=o;try{s=await fetch(r,t)}catch(e){return c(e,d,r,t)}return[200,304].includes(s.status)?(e=await s.arrayBuffer()).byteLength?(0,l.unpack)(new Uint8Array(e)):void 0:c(s,d,r,t)},s=[],d=(t,a)=>new Promise((e,r)=>s.push([t,a,e,r])),e=(e,r,t)=>{var a;u=e,e={"Accept-Language":r||""},t?e.O=t:delete o.O,Object.assign(o,e),d=n;for(a of s)d(...a.slice(0,2)).then(...a.slice(2));s=[]},a=s=>new Proxy(()=>{},{get:(e,r)=>{var t=s;return t&&(t+="."),a(t+r)},set:(e,r,t)=>((i=i||{})[r]=t,!0),apply:(e,r,t)=>{var a,n;return i&&(a=i,i=void 0),n={credentials:"include",headers:a,method:"POST"},t.length&&(n.body=y(t),f in a||(a[f]="")),d(u+s,n)}});return[a(""),e]};